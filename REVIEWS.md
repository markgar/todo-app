# Code Review Findings

- [x] **src/TodoApp.Api/Program.cs (POST /api/todos)**: Mass assignment vulnerability — the endpoint binds the full `TodoItem` model from the request body, allowing clients to set `Id` and `IsComplete` directly. The spec says POST accepts only `title`. Fix: accept a DTO or anonymous type with only `Title`, and let the server assign `Id` and default `IsComplete` to `false`.
- [x] **src/TodoApp.Api/Program.cs (PUT /api/todos/{id})**: No validation on `input.Title` — a client can send a null or empty `Title`, violating the `required` constraint on the model and leaving the todo in an inconsistent state. Fix: return 400 (Bad Request) if `Title` is null or empty before applying the update.
- [x] **src/TodoApp.Api/Program.cs (POST /api/todos)**: No validation that `Title` is non-empty — a client can POST `{"title": ""}` and the API will persist a todo with a blank title. The `required` keyword only enforces C# initialization, not runtime content validation. Fix: return 400 if `Title` is null, empty, or whitespace before saving.
- [x] **tests/TodoApp.Data.Tests/TodoApp.Data.Tests.csproj**: xUnit major-version mismatch — `xunit` 2.9.3 (v2, deprecated) is mixed with `xunit.runner.visualstudio` 3.1.4 (v3), which can cause test discovery or execution failures. Fix: either upgrade to xUnit v3 consistently or pin the runner to a v2-compatible version (e.g., `xunit.runner.visualstudio` 2.5.6).
- [x] **tests/TodoApp.Api.Tests/TodoApiIntegrationTests.cs**: Duplicate test class — `TodoApiIntegrationTests` is nearly identical to the existing `TodoApiTests` in the same project (same fixture, same endpoints, same assertions with minor wording differences). This adds maintenance burden and doubles test runtime for no additional coverage. Fix: delete `TodoApiIntegrationTests.cs` and keep only `TodoApiTests.cs`.
- [x] **tests/TodoApp.Api.Tests/TodoApiIntegrationTests.cs**: Missing PUT test — the spec (task #36) requires a test for `PUT /api/todos/{id}`, but this class omits it while the duplicate `TodoApiTests` includes it. Fix: if this class is kept, add the missing PUT test to match the required test coverage.
- [x] **tests/TodoApp.Api.Tests/TodoApp.Api.Tests.csproj**: xUnit major-version mismatch — `xunit` 2.9.3 (v2) is mixed with `xunit.runner.visualstudio` 3.1.4 (v3), same issue as `TodoApp.Data.Tests`. Fix: align both packages to the same major version.
- [x] **tests/TodoApp.Api.Tests/TodoApiValidationTests.cs (`PostTodo_IgnoresClientSuppliedIdAndIsComplete`)**: Test name claims to verify that client-supplied `Id` is ignored, but the test never sets `Id` to a specific value and has no assertion that the returned `Id` differs from a client-supplied one. Only `IsComplete` is actually verified. Fix: set `Id` to an explicit value (e.g., `Id = 9999`) in the request and assert that `created.Id != 9999` to confirm the server ignores it.
